import numpy as np

import torch
from torch.utils.data import DataLoader

# local package
from libs import tpcpath
from libs.dataset import SimpleSceneDataset
from libs.three_nn import three_nn # PointRCNN

# torch-points-kernels
import torch_points_kernels as tpk

# torchpcp pacakage
from torchpcp.modules.functional.other import index2points
from torchpcp.modules.functional.sampling import furthest_point_sampling
from torchpcp.modules.functional import nns
from torchpcp.utils.monitor import timecheck
from torchpcp.utils import pytorch_tools

# pytorch_tools.set_seed(0)
device = pytorch_tools.select_device("cuda")

def speed_test(method, loader):
    for i, data in enumerate(loader): pass # for speed processing
    
    # print name
    if method == 0:
        t_name = "original c++ impl. time"
    elif method == 1:
        t_name = "original py impl. time"
    elif method == 2:
        t_name = "other c++ impl. time"
    elif method == 3:
        t_name = "tpk impl. time"
    else:
        raise NotImplementedError()

    # timer start
    t = timecheck()
    for _ in range(100):
        for i, data in enumerate(loader):
            point_clouds, sem_labels, ins_labels = data
            point_clouds = torch.transpose(point_clouds[:, :, :3].to(device), 1, 2)
            center_idxs = furthest_point_sampling(point_clouds, 1024)
            center_pc = index2points(point_clouds, center_idxs)
            if method == 0:
                pred, _ = nns.k_nearest_neighbors(center_pc, point_clouds, k=3)
            elif method == 1:
                pred, _ = nns.py_k_nearest_neighbors(center_pc, point_clouds, k=3, memory_saving=False)
            elif method == 2:
                pred = three_nn(center_pc.transpose(1,2).contiguous(), point_clouds.transpose(1,2).contiguous())
            elif method == 3:
                pred, _ = tpk.knn(point_clouds.transpose(1,2).contiguous(), center_pc.transpose(1,2).contiguous(), 3)
            else:
                raise NotImplementedError()
    # timer end
    timecheck(t, t_name)

    gt, _ = nns.py_k_nearest_neighbors(center_pc, point_clouds, k=3, memory_saving=False)

    print(False in (pred == gt))

np.set_printoptions(threshold=np.inf)
torch.set_printoptions(threshold=np.inf)

# get dataset
dataset = SimpleSceneDataset()
points, sem_label, ins_label = dataset[0]
pc = torch.tensor([points[:, :3]], device="cuda").transpose(1,2)

# compare knn
k = 20
idx, dist = nns.k_nearest_neighbors(pc, pc, k)
idx2, dist2 = nns.py_k_nearest_neighbors(pc, pc, k)
check_idx = idx == idx2
if True:
    for ib in range(len(check_idx)):
        b_idxs = check_idx[ib]
        for i_n in range(len(b_idxs)):
            n_idxs = b_idxs[i_n]
            if False in n_idxs:
                for i_p in range(len(n_idxs)):
                    k_idxs = n_idxs[i_p]
                    if False == k_idxs:
                        print("pyknn ib {}, in {}, ip {} dist {} idx {}".format(ib, i_n, i_p, dist[ib, i_n, i_p], idx[ib, i_n, i_p]))
                        # print("pybq and dist2 {}".format(dist[ib, i_n, i_p]))
                        print("dist {} idx {}".format(dist2[ib, i_n, i_p], idx2[ib, i_n, i_p]))
                    # else:
                    #     print("pyknn ib {}, in {}, ip {} dist {} idx {}".format(ib, i_n, i_p, dist[ib, i_n, i_p], idx[ib, i_n, i_p]))
print("CHECK1:", False in (check_idx))

# â†‘ result (a part)
"""
pyknn ib 0, in 3397, ip 5 dist 0.0005849996232427657 idx 2927
dist 0.0005850791931152344 idx 542
pyknn ib 0, in 3398, ip 10 dist 0.009334004484117031 idx 3892
dist 0.00933384895324707 idx 1082
pyknn ib 0, in 3398, ip 11 dist 0.009334005415439606 idx 1082
dist 0.00933384895324707 idx 3892
pyknn ib 0, in 3402, ip 6 dist 0.01157099287956953 idx 1313
dist 0.011570453643798828 idx 2092
pyknn ib 0, in 3402, ip 7 dist 0.01157099287956953 idx 2092
dist 0.011570453643798828 idx 1313
pyknn ib 0, in 3402, ip 9 dist 0.013051005080342293 idx 2169
dist 0.013050079345703125 idx 2962
pyknn ib 0, in 3402, ip 10 dist 0.013051005080342293 idx 2962
dist 0.013050079345703125 idx 2169
pyknn ib 0, in 3402, ip 14 dist 0.019140997901558876 idx 128
dist 0.019140243530273438 idx 1118
pyknn ib 0, in 3402, ip 15 dist 0.019140997901558876 idx 1118
dist 0.019140243530273438 idx 128
pyknn ib 0, in 3403, ip 2 dist 0.0013459994224831462 idx 3251
dist 0.001345992088317871 idx 3264
pyknn ib 0, in 3403, ip 3 dist 0.0013459994224831462 idx 3264
dist 0.001345992088317871 idx 3251
pyknn ib 0, in 3404, ip 13 dist 0.005812999792397022 idx 2701
dist 0.0058135986328125 idx 3754
pyknn ib 0, in 3404, ip 14 dist 0.005812999792397022 idx 3754
dist 0.0058135986328125 idx 2701
pyknn ib 0, in 3407, ip 4 dist 0.002997000701725483 idx 1947
dist 0.0029970109462738037 idx 3656
pyknn ib 0, in 3407, ip 5 dist 0.002997000701725483 idx 3656
dist 0.0029970109462738037 idx 1947
pyknn ib 0, in 3409, ip 0 dist 0.0 idx 1269
dist -2.384185791015625e-07 idx 3409
pyknn ib 0, in 3409, ip 1 dist 0.0 idx 3409
dist -2.384185791015625e-07 idx 1269
pyknn ib 0, in 3409, ip 17 dist 0.008043000474572182 idx 1042
dist 0.00804293155670166 idx 1482
pyknn ib 0, in 3409, ip 18 dist 0.008043000474572182 idx 1482
dist 0.00804293155670166 idx 1042
pyknn ib 0, in 3410, ip 11 dist 0.005334001034498215 idx 1024
dist 0.00533401221036911 idx 2834
pyknn ib 0, in 3410, ip 12 dist 0.005334001034498215 idx 2834
dist 0.00533401221036911 idx 1024
pyknn ib 0, in 3413, ip 0 dist 0.0 idx 152
dist 0.0 idx 3413
pyknn ib 0, in 3413, ip 1 dist 0.0 idx 3413
dist 0.0 idx 152
pyknn ib 0, in 3413, ip 14 dist 0.010057998821139336 idx 2104
dist 0.010058045387268066 idx 2583
pyknn ib 0, in 3413, ip 15 dist 0.010057998821139336 idx 2583
dist 0.010058045387268066 idx 2104
pyknn ib 0, in 3414, ip 9 dist 0.00410101655870676 idx 2055
dist 0.004100799560546875 idx 2936
pyknn ib 0, in 3414, ip 10 dist 0.00410101655870676 idx 2936
dist 0.004100799560546875 idx 2055
pyknn ib 0, in 3415, ip 1 dist 0.00021200145420152694 idx 1176
dist 0.0002117156982421875 idx 3866
pyknn ib 0, in 3415, ip 2 dist 0.00021200145420152694 idx 3866
dist 0.0002117156982421875 idx 1176
pyknn ib 0, in 3415, ip 11 dist 0.007836993783712387 idx 3519
dist 0.007837295532226562 idx 4066
pyknn ib 0, in 3415, ip 12 dist 0.007836993783712387 idx 4066
dist 0.007837295532226562 idx 3519
pyknn ib 0, in 3416, ip 4 dist 0.001897998503409326 idx 3325
dist 0.001898050308227539 idx 3729
pyknn ib 0, in 3416, ip 5 dist 0.001897998503409326 idx 3729
dist 0.001898050308227539 idx 3325
pyknn ib 0, in 3421, ip 7 dist 0.004901004955172539 idx 1018
dist 0.00490117073059082 idx 3982
pyknn ib 0, in 3421, ip 8 dist 0.004901004955172539 idx 3982
dist 0.00490117073059082 idx 1018
pyknn ib 0, in 3429, ip 3 dist 0.00023299954773392528 idx 1024
dist 0.00023300200700759888 idx 2834
pyknn ib 0, in 3429, ip 4 dist 0.00023299954773392528 idx 2834
dist 0.00023300200700759888 idx 1024
pyknn ib 0, in 3430, ip 13 dist 0.00894500408321619 idx 810
dist 0.008943557739257812 idx 3766
pyknn ib 0, in 3430, ip 14 dist 0.00894500408321619 idx 3766
dist 0.008943557739257812 idx 810
pyknn ib 0, in 3440, ip 4 dist 0.003592999652028084 idx 2143
dist 0.0035930201411247253 idx 4072
pyknn ib 0, in 3440, ip 5 dist 0.003592999652028084 idx 4072
dist 0.0035930201411247253 idx 2143
pyknn ib 0, in 3440, ip 11 dist 0.006083999294787645 idx 2987
dist 0.006083987653255463 idx 868
pyknn ib 0, in 3440, ip 12 dist 0.006084000691771507 idx 868
dist 0.00608399510383606 idx 2987
pyknn ib 0, in 3440, ip 18 dist 0.010029001161456108 idx 0
dist 0.010029010474681854 idx 1032
pyknn ib 0, in 3440, ip 19 dist 0.010029001161456108 idx 1032
dist 0.010029010474681854 idx 0
pyknn ib 0, in 3441, ip 16 dist 0.007686000782996416 idx 0
dist 0.007686004042625427 idx 1032
pyknn ib 0, in 3441, ip 17 dist 0.007686000782996416 idx 1032
dist 0.007686004042625427 idx 1850
pyknn ib 0, in 3441, ip 18 dist 0.007686000782996416 idx 1850
dist 0.007686004042625427 idx 0
pyknn ib 0, in 3442, ip 11 dist 0.004209999926388264 idx 1947
dist 0.004209995269775391 idx 3656
pyknn ib 0, in 3442, ip 12 dist 0.004209999926388264 idx 3656
dist 0.004209995269775391 idx 1947
pyknn ib 0, in 3445, ip 10 dist 0.004147999454289675 idx 488
dist 0.004148006439208984 idx 2434
pyknn ib 0, in 3445, ip 11 dist 0.004147999454289675 idx 2434
dist 0.004148006439208984 idx 488
pyknn ib 0, in 3456, ip 7 dist 0.0031460002064704895 idx 1024
dist 0.0031460076570510864 idx 2834
pyknn ib 0, in 3456, ip 8 dist 0.0031460002064704895 idx 2834
dist 0.0031460076570510864 idx 1024
pyknn ib 0, in 3456, ip 9 dist 0.004821000155061483 idx 363
dist 0.004821024835109711 idx 694
pyknn ib 0, in 3456, ip 10 dist 0.004821000155061483 idx 694
dist 0.004821024835109711 idx 363
pyknn ib 0, in 3456, ip 11 dist 0.004900998901575804 idx 2953
dist 0.004901014268398285 idx 3429
pyknn ib 0, in 3456, ip 12 dist 0.004900998901575804 idx 3429
dist 0.004901014268398285 idx 2953
pyknn ib 0, in 3461, ip 13 dist 0.013138998299837112 idx 1212
dist 0.013138949871063232 idx 3522
pyknn ib 0, in 3461, ip 14 dist 0.013138998299837112 idx 3522
dist 0.013138949871063232 idx 1212
pyknn ib 0, in 3462, ip 0 dist 0.0 idx 3462
dist 0.0 idx 3465
pyknn ib 0, in 3462, ip 1 dist 0.0 idx 3465
dist 0.0 idx 3462
pyknn ib 0, in 3465, ip 0 dist 0.0 idx 3462
dist 0.0 idx 3465
pyknn ib 0, in 3465, ip 1 dist 0.0 idx 3465
dist 0.0 idx 3462
pyknn ib 0, in 3470, ip 9 dist 0.0076049999333918095 idx 281
dist 0.007604971528053284 idx 2437
pyknn ib 0, in 3470, ip 10 dist 0.0076049999333918095 idx 2437
dist 0.007604971528053284 idx 281
pyknn ib 0, in 3472, ip 18 dist 0.014760998077690601 idx 158
dist 0.014760971069335938 idx 1404
pyknn ib 0, in 3472, ip 19 dist 0.014760998077690601 idx 1404
dist 0.014760971069335938 idx 158
pyknn ib 0, in 3474, ip 12 dist 0.010493999347090721 idx 666
dist 0.010493874549865723 idx 2543
pyknn ib 0, in 3474, ip 13 dist 0.010493999347090721 idx 2543
dist 0.010493874549865723 idx 666
pyknn ib 0, in 3474, ip 15 dist 0.011125998571515083 idx 1590
dist 0.011126160621643066 idx 2927
pyknn ib 0, in 3474, ip 16 dist 0.011125998571515083 idx 2927
dist 0.011126160621643066 idx 1590
pyknn ib 0, in 3480, ip 4 dist 0.012818001210689545 idx 1951
dist 0.012817949056625366 idx 2710
pyknn ib 0, in 3480, ip 5 dist 0.012818001210689545 idx 2710
dist 0.012817949056625366 idx 1951
pyknn ib 0, in 3481, ip 2 dist 0.000298000784823671 idx 128
dist 0.0002970695495605469 idx 1118
pyknn ib 0, in 3481, ip 3 dist 0.000298000784823671 idx 1118
dist 0.0002970695495605469 idx 128
pyknn ib 0, in 3481, ip 9 dist 0.004514000378549099 idx 1313
dist 0.004513740539550781 idx 2092
pyknn ib 0, in 3481, ip 10 dist 0.004514000378549099 idx 2092
dist 0.004513740539550781 idx 1313
pyknn ib 0, in 3488, ip 6 dist 0.005204994697123766 idx 1304
dist 0.005205094814300537 idx 2654
pyknn ib 0, in 3488, ip 7 dist 0.005204994697123766 idx 2654
dist 0.005205094814300537 idx 1304
pyknn ib 0, in 3488, ip 11 dist 0.00811500009149313 idx 2397
dist 0.008115053176879883 idx 4050
pyknn ib 0, in 3488, ip 12 dist 0.00811500009149313 idx 4050
dist 0.008115053176879883 idx 2397
pyknn ib 0, in 3491, ip 18 dist 0.008860995061695576 idx 1304
dist 0.008860945701599121 idx 2654
pyknn ib 0, in 3491, ip 19 dist 0.008860995061695576 idx 2654
dist 0.008860945701599121 idx 1304
pyknn ib 0, in 3495, ip 0 dist 0.0 idx 1425
dist 0.0 idx 3495
pyknn ib 0, in 3495, ip 1 dist 0.0 idx 3495
dist 0.0 idx 1425
pyknn ib 0, in 3500, ip 18 dist 0.013730003498494625 idx 1487
dist 0.01372992992401123 idx 3004
pyknn ib 0, in 3500, ip 19 dist 0.013730003498494625 idx 3004
dist 0.01372992992401123 idx 1487
pyknn ib 0, in 3501, ip 2 dist 0.0018849981715902686 idx 1225
dist 0.0018854141235351562 idx 1637
pyknn ib 0, in 3501, ip 3 dist 0.0018849981715902686 idx 1637
dist 0.0018854141235351562 idx 1225
pyknn ib 0, in 3504, ip 3 dist 0.0021460067946463823 idx 869
dist 0.0021452903747558594 idx 2454
pyknn ib 0, in 3504, ip 4 dist 0.0021460067946463823 idx 2454
dist 0.0021452903747558594 idx 869
pyknn ib 0, in 3507, ip 10 dist 0.006412987597286701 idx 1487
dist 0.0064127445220947266 idx 3004
pyknn ib 0, in 3507, ip 11 dist 0.006412987597286701 idx 3004
dist 0.0064127445220947266 idx 1487
pyknn ib 0, in 3508, ip 1 dist 0.001189997885376215 idx 1052
dist 0.0011899471282958984 idx 2093
pyknn ib 0, in 3508, ip 2 dist 0.001189997885376215 idx 2093
dist 0.0011899471282958984 idx 1052
pyknn ib 0, in 3509, ip 1 dist 0.0012090002419427037 idx 1304
dist 0.001208961009979248 idx 2654
pyknn ib 0, in 3509, ip 2 dist 0.0012090002419427037 idx 2654
dist 0.001208961009979248 idx 1304
pyknn ib 0, in 3511, ip 8 dist 0.002437000395730138 idx 2701
dist 0.002437591552734375 idx 3754
pyknn ib 0, in 3511, ip 9 dist 0.002437000395730138 idx 3754
dist 0.002437591552734375 idx 2701
pyknn ib 0, in 3512, ip 10 dist 0.006725003011524677 idx 937
dist 0.006725311279296875 idx 2228
pyknn ib 0, in 3512, ip 11 dist 0.006725003011524677 idx 2228
dist 0.006725311279296875 idx 937
pyknn ib 0, in 3512, ip 18 dist 0.014550035819411278 idx 1400
dist 0.014549732208251953 idx 3069
pyknn ib 0, in 3512, ip 19 dist 0.014550035819411278 idx 3069
dist 0.014549732208251953 idx 1400
pyknn ib 0, in 3519, ip 0 dist 0.0 idx 3519
dist 0.0 idx 4066
pyknn ib 0, in 3519, ip 1 dist 0.0 idx 4066
dist 0.0 idx 3519
pyknn ib 0, in 3519, ip 2 dist 0.0004419961478561163 idx 829
dist 0.00044155120849609375 idx 3173
pyknn ib 0, in 3519, ip 3 dist 0.0004419961478561163 idx 3173
dist 0.00044155120849609375 idx 829
pyknn ib 0, in 3520, ip 1 dist 0.00022599961084779352 idx 818
dist 0.00022605061531066895 idx 3318
pyknn ib 0, in 3520, ip 2 dist 0.00022599961084779352 idx 3318
dist 0.00022605061531066895 idx 818
pyknn ib 0, in 3524, ip 10 dist 0.006727982312440872 idx 810
dist 0.006728172302246094 idx 3766
pyknn ib 0, in 3524, ip 11 dist 0.006727982312440872 idx 3766
dist 0.006728172302246094 idx 810
pyknn ib 0, in 3525, ip 4 dist 0.001409997814334929 idx 1649
dist 0.0014100074768066406 idx 3471
pyknn ib 0, in 3525, ip 5 dist 0.001409997814334929 idx 3471
dist 0.0014100074768066406 idx 1649
pyknn ib 0, in 3526, ip 6 dist 0.00230899965390563 idx 1123
dist 0.0023088455200195312 idx 2937
pyknn ib 0, in 3526, ip 7 dist 0.00230899965390563 idx 2937
dist 0.0023088455200195312 idx 1123
pyknn ib 0, in 3527, ip 10 dist 0.009864001534879208 idx 1212
dist 0.009863987565040588 idx 3522
pyknn ib 0, in 3527, ip 11 dist 0.009864001534879208 idx 3522
dist 0.009863987565040588 idx 1212
pyknn ib 0, in 3528, ip 3 dist 0.0019439997849985957 idx 1947
dist 0.0019440054893493652 idx 3656
pyknn ib 0, in 3528, ip 4 dist 0.0019439997849985957 idx 3656
dist 0.0019440054893493652 idx 1947
pyknn ib 0, in 3530, ip 11 dist 0.004930997267365456 idx 1871
dist 0.0049304962158203125 idx 3541
pyknn ib 0, in 3530, ip 12 dist 0.004930997267365456 idx 3541
dist 0.0049304962158203125 idx 1871
pyknn ib 0, in 3535, ip 2 dist 0.00040199910290539265 idx 2176
dist 0.00040340423583984375 idx 2815
pyknn ib 0, in 3535, ip 3 dist 0.00040199910290539265 idx 2815
dist 0.00040340423583984375 idx 2176
pyknn ib 0, in 3541, ip 0 dist 0.0 idx 1871
dist -1.9073486328125e-06 idx 3541
pyknn ib 0, in 3541, ip 1 dist 0.0 idx 3541
dist -1.9073486328125e-06 idx 1871
pyknn ib 0, in 3546, ip 11 dist 0.005651996936649084 idx 2316
dist 0.005651950836181641 idx 2761
pyknn ib 0, in 3546, ip 12 dist 0.005651996936649084 idx 2761
dist 0.005651950836181641 idx 2316
pyknn ib 0, in 3553, ip 16 dist 0.003945999778807163 idx 2502
dist 0.003945887088775635 idx 3168
pyknn ib 0, in 3553, ip 17 dist 0.003945999778807163 idx 3168
dist 0.003945887088775635 idx 2502
pyknn ib 0, in 3560, ip 11 dist 0.00826500728726387 idx 2745
dist 0.008264780044555664 idx 3933
pyknn ib 0, in 3560, ip 12 dist 0.00826500728726387 idx 3933
dist 0.008264780044555664 idx 2745
pyknn ib 0, in 3567, ip 7 dist 0.004524988122284412 idx 1297
dist 0.00452423095703125 idx 2984
pyknn ib 0, in 3567, ip 8 dist 0.004524995107203722 idx 2984
dist 0.00452423095703125 idx 1297
pyknn ib 0, in 3575, ip 2 dist 0.0017249988159164786 idx 2854
dist 0.0017247200012207031 idx 3996
pyknn ib 0, in 3575, ip 3 dist 0.0017249988159164786 idx 3996
dist 0.0017247200012207031 idx 2854
pyknn ib 0, in 3579, ip 1 dist 0.00023399594647344202 idx 810
dist 0.000232696533203125 idx 3766
pyknn ib 0, in 3579, ip 2 dist 0.00023399594647344202 idx 3766
dist 0.000232696533203125 idx 810
pyknn ib 0, in 3579, ip 10 dist 0.008099023252725601 idx 1093
dist 0.008098602294921875 idx 2320
pyknn ib 0, in 3579, ip 11 dist 0.008099023252725601 idx 2320
dist 0.008098602294921875 idx 1093
pyknn ib 0, in 3581, ip 9 dist 0.006384999491274357 idx 2176
dist 0.00638580322265625 idx 2815
pyknn ib 0, in 3581, ip 10 dist 0.006384999491274357 idx 2815
dist 0.00638580322265625 idx 2176
pyknn ib 0, in 3582, ip 11 dist 0.006272999569773674 idx 1952
dist 0.00627291202545166 idx 2823
pyknn ib 0, in 3582, ip 12 dist 0.006272999569773674 idx 2823
dist 0.00627291202545166 idx 1952
pyknn ib 0, in 3583, ip 1 dist 0.0015939960721880198 idx 1313
dist 0.0015935897827148438 idx 2092
pyknn ib 0, in 3583, ip 2 dist 0.0015939960721880198 idx 2092
dist 0.0015935897827148438 idx 1313
pyknn ib 0, in 3594, ip 12 dist 0.006574000231921673 idx 849
dist 0.006572723388671875 idx 1128
pyknn ib 0, in 3594, ip 13 dist 0.006574000231921673 idx 1128
dist 0.006572723388671875 idx 849
pyknn ib 0, in 3598, ip 18 dist 0.008245003409683704 idx 193
dist 0.008244991302490234 idx 231
pyknn ib 0, in 3598, ip 19 dist 0.008245003409683704 idx 231
dist 0.008244991302490234 idx 193
pyknn ib 0, in 3600, ip 11 dist 0.0064890035428106785 idx 1059
dist 0.006489008665084839 idx 3232
pyknn ib 0, in 3600, ip 12 dist 0.0064890035428106785 idx 3232
dist 0.006489008665084839 idx 1059
pyknn ib 0, in 3610, ip 14 dist 0.007984996773302555 idx 1925
dist 0.00798499584197998 idx 2416
pyknn ib 0, in 3610, ip 15 dist 0.007984996773302555 idx 2416
dist 0.00798499584197998 idx 1925
pyknn ib 0, in 3612, ip 5 dist 0.0035329984966665506 idx 2316
dist 0.003532886505126953 idx 2761
pyknn ib 0, in 3612, ip 6 dist 0.0035329984966665506 idx 2761
dist 0.003532886505126953 idx 2316
pyknn ib 0, in 3621, ip 10 dist 0.006896963343024254 idx 937
dist 0.006896495819091797 idx 2228
pyknn ib 0, in 3621, ip 11 dist 0.006896963343024254 idx 2228
dist 0.006896495819091797 idx 937
pyknn ib 0, in 3627, ip 11 dist 0.008366001769900322 idx 767
dist 0.008365988731384277 idx 1375
pyknn ib 0, in 3627, ip 13 dist 0.008366001769900322 idx 1375
dist 0.008365988731384277 idx 767
pyknn ib 0, in 3629, ip 12 dist 0.0073130009695887566 idx 403
dist 0.007312774658203125 idx 2045
pyknn ib 0, in 3629, ip 13 dist 0.0073130009695887566 idx 2045
dist 0.007312774658203125 idx 403
pyknn ib 0, in 3631, ip 0 dist 0.0 idx 3631
dist 0.0 idx 4089
pyknn ib 0, in 3631, ip 1 dist 0.0 idx 4089
dist 0.0 idx 3631
pyknn ib 0, in 3634, ip 18 dist 0.009790007025003433 idx 2397
dist 0.00978994369506836 idx 4050
pyknn ib 0, in 3634, ip 19 dist 0.009790007025003433 idx 4050
dist 0.00978994369506836 idx 2397
pyknn ib 0, in 3635, ip 0 dist 0.0 idx 1906
dist 9.5367431640625e-07 idx 3635
pyknn ib 0, in 3635, ip 1 dist 0.0 idx 3635
dist 9.5367431640625e-07 idx 1906
pyknn ib 0, in 3635, ip 7 dist 0.006624998524785042 idx 2790
dist 0.006625652313232422 idx 3722
pyknn ib 0, in 3635, ip 8 dist 0.006624998524785042 idx 3722
dist 0.006625652313232422 idx 2790
pyknn ib 0, in 3637, ip 18 dist 0.010817998088896275 idx 1123
dist 0.010816574096679688 idx 2937
pyknn ib 0, in 3637, ip 19 dist 0.010817998088896275 idx 2937
dist 0.010816574096679688 idx 1123
pyknn ib 0, in 3638, ip 0 dist 0.0 idx 2780
dist -4.76837158203125e-07 idx 3638
pyknn ib 0, in 3638, ip 1 dist 0.0 idx 3638
dist -4.76837158203125e-07 idx 2780
pyknn ib 0, in 3642, ip 4 dist 0.0014510012697428465 idx 363
dist 0.0014509856700897217 idx 694
pyknn ib 0, in 3642, ip 5 dist 0.0014510012697428465 idx 694
dist 0.0014509856700897217 idx 363
pyknn ib 0, in 3645, ip 8 dist 0.0035089822486042976 idx 615
dist 0.0035085678100585938 idx 2297
pyknn ib 0, in 3645, ip 9 dist 0.0035089822486042976 idx 2297
dist 0.0035085678100585938 idx 615
pyknn ib 0, in 3653, ip 8 dist 0.005330007988959551 idx 236
dist 0.0053310394287109375 idx 1959
pyknn ib 0, in 3653, ip 9 dist 0.005330007988959551 idx 1959
dist 0.0053310394287109375 idx 236
pyknn ib 0, in 3653, ip 12 dist 0.007883005775511265 idx 483
dist 0.007884025573730469 idx 2764
pyknn ib 0, in 3653, ip 13 dist 0.007883005775511265 idx 2764
dist 0.007884025573730469 idx 483
pyknn ib 0, in 3655, ip 10 dist 0.005937003064900637 idx 962
dist 0.005936622619628906 idx 3213
pyknn ib 0, in 3655, ip 11 dist 0.005937003064900637 idx 3213
dist 0.005936622619628906 idx 962
pyknn ib 0, in 3656, ip 0 dist 0.0 idx 1947
dist 5.960464477539063e-08 idx 3656
pyknn ib 0, in 3656, ip 1 dist 0.0 idx 3656
dist 5.960464477539063e-08 idx 1947
pyknn ib 0, in 3668, ip 4 dist 0.002050999319180846 idx 829
dist 0.0020503997802734375 idx 3173
pyknn ib 0, in 3668, ip 5 dist 0.002050999319180846 idx 3173
dist 0.0020503997802734375 idx 829
pyknn ib 0, in 3668, ip 9 dist 0.0033809910528361797 idx 3519
dist 0.0033788681030273438 idx 4066
pyknn ib 0, in 3668, ip 10 dist 0.0033809910528361797 idx 4066
dist 0.0033788681030273438 idx 3519
pyknn ib 0, in 3673, ip 11 dist 0.005558010656386614 idx 1052
dist 0.0055577754974365234 idx 2093
pyknn ib 0, in 3673, ip 12 dist 0.005558010656386614 idx 2093
dist 0.0055577754974365234 idx 1052
pyknn ib 0, in 3674, ip 2 dist 0.0007700005662627518 idx 344
dist 0.0007699877023696899 idx 1751
pyknn ib 0, in 3674, ip 3 dist 0.0007700005662627518 idx 1751
dist 0.0007699877023696899 idx 344
pyknn ib 0, in 3675, ip 10 dist 0.006197004113346338 idx 3140
dist 0.006197214126586914 idx 2736
pyknn ib 0, in 3675, ip 11 dist 0.006197008304297924 idx 2736
dist 0.006197214126586914 idx 3140
pyknn ib 0, in 3682, ip 2 dist 0.000953999871853739 idx 1031
dist 0.0009539127349853516 idx 1100
pyknn ib 0, in 3682, ip 3 dist 0.000953999871853739 idx 1100
dist 0.0009539127349853516 idx 2711
pyknn ib 0, in 3682, ip 4 dist 0.000953999871853739 idx 2711
dist 0.0009539127349853516 idx 1031
pyknn ib 0, in 3682, ip 5 dist 0.002277006395161152 idx 744
dist 0.002276897430419922 idx 3909
pyknn ib 0, in 3682, ip 6 dist 0.002277006395161152 idx 3909
dist 0.002276897430419922 idx 744
pyknn ib 0, in 3685, ip 6 dist 0.0022769994102418423 idx 1032
dist 0.002277001738548279 idx 1850
pyknn ib 0, in 3685, ip 7 dist 0.0022769994102418423 idx 1850
dist 0.002277001738548279 idx 1032
pyknn ib 0, in 3686, ip 18 dist 0.012762016616761684 idx 962
dist 0.012761116027832031 idx 3213
pyknn ib 0, in 3686, ip 19 dist 0.012762016616761684 idx 3213
dist 0.012761116027832031 idx 962
pyknn ib 0, in 3699, ip 9 dist 0.006161997560411692 idx 158
dist 0.006161689758300781 idx 1404
pyknn ib 0, in 3699, ip 10 dist 0.006161997560411692 idx 1404
dist 0.006161689758300781 idx 158
pyknn ib 0, in 3703, ip 0 dist 0.0 idx 963
dist 0.0 idx 3703
pyknn ib 0, in 3703, ip 1 dist 0.0 idx 3703
dist 0.0 idx 963
pyknn ib 0, in 3705, ip 7 dist 0.005197002552449703 idx 869
dist 0.005197048187255859 idx 2454
pyknn ib 0, in 3705, ip 8 dist 0.005197002552449703 idx 2454
dist 0.005197048187255859 idx 869
pyknn ib 0, in 3706, ip 1 dist 0.0005649998784065247 idx 497
dist 0.0005649328231811523 idx 2785
pyknn ib 0, in 3706, ip 2 dist 0.0005649998784065247 idx 2785
dist 0.0005649328231811523 idx 497
pyknn ib 0, in 3707, ip 0 dist 0.0 idx 719
dist -4.76837158203125e-07 idx 3707
pyknn ib 0, in 3707, ip 1 dist 0.0 idx 3707
dist -4.76837158203125e-07 idx 719
pyknn ib 0, in 3714, ip 5 dist 0.0016370017547160387 idx 2328
dist 0.0016369819641113281 idx 3774
pyknn ib 0, in 3714, ip 6 dist 0.0016370017547160387 idx 3774
dist 0.0016369819641113281 idx 2328
pyknn ib 0, in 3715, ip 3 dist 0.000400999968405813 idx 636
dist 0.0004010051488876343 idx 3362
pyknn ib 0, in 3715, ip 4 dist 0.000400999968405813 idx 3362
dist 0.0004010051488876343 idx 636
pyknn ib 0, in 3717, ip 10 dist 0.0069059995003044605 idx 767
dist 0.0069060176610946655 idx 1375
pyknn ib 0, in 3717, ip 12 dist 0.0069059995003044605 idx 1375
dist 0.0069060176610946655 idx 767
pyknn ib 0, in 3720, ip 5 dist 0.0029769993852823973 idx 1024
dist 0.0029769912362098694 idx 2834
pyknn ib 0, in 3720, ip 6 dist 0.0029769993852823973 idx 2834
dist 0.0029769912362098694 idx 1024
pyknn ib 0, in 3720, ip 8 dist 0.0040999967604875565 idx 2953
dist 0.004099994897842407 idx 3429
pyknn ib 0, in 3720, ip 9 dist 0.0040999967604875565 idx 3429
dist 0.004099994897842407 idx 2953
pyknn ib 0, in 3721, ip 1 dist 0.0002810000441968441 idx 1647
dist 0.0002810955047607422 idx 2457
pyknn ib 0, in 3721, ip 2 dist 0.0002810000441968441 idx 2457
dist 0.0002810955047607422 idx 1647
pyknn ib 0, in 3721, ip 12 dist 0.006165006663650274 idx 282
dist 0.0061647891998291016 idx 2323
pyknn ib 0, in 3721, ip 13 dist 0.006165006663650274 idx 2323
dist 0.0061647891998291016 idx 282
pyknn ib 0, in 3722, ip 0 dist 0.0 idx 2790
dist 0.0 idx 3722
pyknn ib 0, in 3722, ip 1 dist 0.0 idx 3722
dist 0.0 idx 2790
pyknn ib 0, in 3722, ip 14 dist 0.006624998524785042 idx 1906
dist 0.006625652313232422 idx 3635
pyknn ib 0, in 3722, ip 15 dist 0.006624998524785042 idx 3635
dist 0.006625652313232422 idx 1906
pyknn ib 0, in 3723, ip 11 dist 0.006090002600103617 idx 497
dist 0.006090044975280762 idx 2785
pyknn ib 0, in 3723, ip 12 dist 0.006090002600103617 idx 2785
dist 0.006090044975280762 idx 497
pyknn ib 0, in 3725, ip 9 dist 0.004778000060468912 idx 683
dist 0.004777997732162476 idx 3377
pyknn ib 0, in 3725, ip 10 dist 0.004778000060468912 idx 2705
dist 0.004777997732162476 idx 683
pyknn ib 0, in 3725, ip 11 dist 0.004778000060468912 idx 3377
dist 0.004777997732162476 idx 2705
pyknn ib 0, in 3728, ip 5 dist 0.003074999898672104 idx 722
dist 0.0030749994330108166 idx 3776
pyknn ib 0, in 3728, ip 6 dist 0.003074999898672104 idx 3776
dist 0.0030749994330108166 idx 722
pyknn ib 0, in 3731, ip 16 dist 0.01155802421271801 idx 2854
dist 0.011558055877685547 idx 3996
pyknn ib 0, in 3731, ip 17 dist 0.01155802421271801 idx 3996
dist 0.011558055877685547 idx 2854
pyknn ib 0, in 3734, ip 2 dist 0.0009229975985363126 idx 1649
dist 0.0009236335754394531 idx 3471
pyknn ib 0, in 3734, ip 3 dist 0.0009229975985363126 idx 3471
dist 0.0009236335754394531 idx 1649
pyknn ib 0, in 3737, ip 0 dist 0.0 idx 3261
dist 0.0 idx 3737
pyknn ib 0, in 3737, ip 1 dist 0.0 idx 3737
dist 0.0 idx 3261
pyknn ib 0, in 3738, ip 3 dist 0.0022369935177266598 idx 959
dist 0.0022363662719726562 idx 2733
pyknn ib 0, in 3738, ip 4 dist 0.0022370037622749805 idx 2733
dist 0.0022363662719726562 idx 959
pyknn ib 0, in 3740, ip 1 dist 0.0019520005444064736 idx 1647
dist 0.0019516944885253906 idx 2457
pyknn ib 0, in 3740, ip 2 dist 0.0019520005444064736 idx 2457
dist 0.0019516944885253906 idx 1647
pyknn ib 0, in 3740, ip 4 dist 0.0031559993512928486 idx 282
dist 0.0031557083129882812 idx 2323
pyknn ib 0, in 3740, ip 5 dist 0.0031559993512928486 idx 2323
dist 0.0031557083129882812 idx 282
pyknn ib 0, in 3742, ip 11 dist 0.007034010253846645 idx 937
dist 0.007033348083496094 idx 2228
pyknn ib 0, in 3742, ip 12 dist 0.007034010253846645 idx 2228
dist 0.007033348083496094 idx 937
pyknn ib 0, in 3746, ip 4 dist 0.0036910013295710087 idx 1342
dist 0.003690958023071289 idx 2235
pyknn ib 0, in 3746, ip 5 dist 0.0036910013295710087 idx 2235
dist 0.003690958023071289 idx 1342
pyknn ib 0, in 3746, ip 6 dist 0.003737997729331255 idx 847
dist 0.003737926483154297 idx 2932
pyknn ib 0, in 3746, ip 7 dist 0.003737997729331255 idx 2932
dist 0.003737926483154297 idx 847
pyknn ib 0, in 3749, ip 11 dist 0.004900988657027483 idx 2055
dist 0.004900932312011719 idx 2936
pyknn ib 0, in 3749, ip 12 dist 0.004900988657027483 idx 2936
dist 0.004900932312011719 idx 2055
pyknn ib 0, in 3752, ip 6 dist 0.0036260022316128016 idx 1248
dist 0.0036258697509765625 idx 3939
pyknn ib 0, in 3752, ip 7 dist 0.0036260022316128016 idx 3939
dist 0.0036258697509765625 idx 1248
pyknn ib 0, in 3753, ip 10 dist 0.005917004309594631 idx 1881
dist 0.0059168338775634766 idx 2188
pyknn ib 0, in 3753, ip 11 dist 0.005917004309594631 idx 2188
dist 0.0059168338775634766 idx 1881
pyknn ib 0, in 3754, ip 0 dist 0.0 idx 2701
dist 0.0 idx 3754
pyknn ib 0, in 3754, ip 1 dist 0.0 idx 3754
dist 0.0 idx 2701
pyknn ib 0, in 3758, ip 18 dist 0.01014699973165989 idx 127
dist 0.010146856307983398 idx 2848
pyknn ib 0, in 3758, ip 19 dist 0.01014699973165989 idx 2848
dist 0.010146856307983398 idx 127
pyknn ib 0, in 3765, ip 3 dist 0.001645983662456274 idx 2854
dist 0.0016455650329589844 idx 3996
pyknn ib 0, in 3765, ip 4 dist 0.001645983662456274 idx 3996
dist 0.0016455650329589844 idx 2854
pyknn ib 0, in 3766, ip 0 dist 0.0 idx 810
dist -1.9073486328125e-06 idx 3766
pyknn ib 0, in 3766, ip 1 dist 0.0 idx 3766
dist -1.9073486328125e-06 idx 810
pyknn ib 0, in 3767, ip 5 dist 0.004002002067863941 idx 3251
dist 0.0040018558502197266 idx 3264
pyknn ib 0, in 3767, ip 6 dist 0.004002002067863941 idx 3264
dist 0.0040018558502197266 idx 3251
pyknn ib 0, in 3768, ip 9 dist 0.005507001653313637 idx 1167
dist 0.005507469177246094 idx 2174
pyknn ib 0, in 3768, ip 10 dist 0.005507001653313637 idx 2174
dist 0.005507469177246094 idx 1167
pyknn ib 0, in 3774, ip 0 dist 0.0 idx 2328
dist 0.0 idx 3774
pyknn ib 0, in 3774, ip 1 dist 0.0 idx 3774
dist 0.0 idx 2328
pyknn ib 0, in 3776, ip 0 dist 0.0 idx 722
dist 0.0 idx 3776
pyknn ib 0, in 3776, ip 1 dist 0.0 idx 3776
dist 0.0 idx 722
pyknn ib 0, in 3777, ip 0 dist 0.0 idx 1062
dist 5.960464477539063e-08 idx 3777
pyknn ib 0, in 3777, ip 2 dist 0.0 idx 3777
dist 5.960464477539063e-08 idx 1062
pyknn ib 0, in 3778, ip 14 dist 0.006602999288588762 idx 722
dist 0.006602998822927475 idx 3776
pyknn ib 0, in 3778, ip 15 dist 0.006602999288588762 idx 3776
dist 0.006602998822927475 idx 722
pyknn ib 0, in 3785, ip 17 dist 0.010439997538924217 idx 363
dist 0.01043999195098877 idx 694
pyknn ib 0, in 3785, ip 18 dist 0.010439997538924217 idx 694
dist 0.01043999195098877 idx 363
pyknn ib 0, in 3791, ip 16 dist 0.010437000542879105 idx 722
dist 0.01043699961155653 idx 3776
pyknn ib 0, in 3791, ip 17 dist 0.010437000542879105 idx 3776
dist 0.01043699961155653 idx 722
pyknn ib 0, in 3792, ip 3 dist 0.001552001223899424 idx 1871
dist 0.0015506744384765625 idx 3541
pyknn ib 0, in 3792, ip 4 dist 0.001552001223899424 idx 3541
dist 0.0015506744384765625 idx 1871
pyknn ib 0, in 3792, ip 18 dist 0.013074001297354698 idx 1167
dist 0.013072013854980469 idx 2174
pyknn ib 0, in 3792, ip 19 dist 0.013074001297354698 idx 2174
dist 0.013072013854980469 idx 1167
pyknn ib 0, in 3796, ip 18 dist 0.011904004961252213 idx 963
dist 0.011904239654541016 idx 3703
pyknn ib 0, in 3796, ip 19 dist 0.011904004961252213 idx 3703
dist 0.011904239654541016 idx 963
pyknn ib 0, in 3797, ip 1 dist 0.00010100007784785703 idx 3325
dist 0.00010102987289428711 idx 3729
pyknn ib 0, in 3797, ip 2 dist 0.00010100007784785703 idx 3729
dist 0.00010102987289428711 idx 3325
pyknn ib 0, in 3799, ip 3 dist 0.00041699971188791096 idx 2266
dist 0.0004177093505859375 idx 3388
pyknn ib 0, in 3799, ip 4 dist 0.00041699971188791096 idx 3388
dist 0.0004177093505859375 idx 2266
pyknn ib 0, in 3802, ip 14 dist 0.011641998775303364 idx 3383
dist 0.011641979217529297 idx 3439
pyknn ib 0, in 3802, ip 15 dist 0.011641998775303364 idx 3439
dist 0.011641979217529297 idx 3383
pyknn ib 0, in 3805, ip 7 dist 0.0040910011157393456 idx 792
dist 0.004091024398803711 idx 974
pyknn ib 0, in 3805, ip 8 dist 0.0040910011157393456 idx 974
dist 0.004091024398803711 idx 792
pyknn ib 0, in 3807, ip 14 dist 0.008724001236259937 idx 744
dist 0.008723974227905273 idx 3909
pyknn ib 0, in 3807, ip 15 dist 0.008724001236259937 idx 3909
dist 0.008723974227905273 idx 744
pyknn ib 0, in 3818, ip 2 dist 0.000551996985450387 idx 2458
dist 0.0005519390106201172 idx 2645
pyknn ib 0, in 3818, ip 3 dist 0.000551996985450387 idx 2645
dist 0.0005519390106201172 idx 2458
pyknn ib 0, in 3821, ip 14 dist 0.004901000298559666 idx 2701
dist 0.004901885986328125 idx 3754
pyknn ib 0, in 3821, ip 15 dist 0.004901000298559666 idx 3754
dist 0.004901885986328125 idx 2701
pyknn ib 0, in 3826, ip 12 dist 0.010700996033847332 idx 1031
dist 0.01070094108581543 idx 1100
pyknn ib 0, in 3826, ip 13 dist 0.010700996033847332 idx 1100
dist 0.01070094108581543 idx 1031
pyknn ib 0, in 3826, ip 16 dist 0.012152014300227165 idx 744
dist 0.01215219497680664 idx 3909
pyknn ib 0, in 3826, ip 17 dist 0.012152014300227165 idx 3909
dist 0.01215219497680664 idx 744
pyknn ib 0, in 3833, ip 9 dist 0.003604000201448798 idx 281
dist 0.003603994846343994 idx 2437
pyknn ib 0, in 3833, ip 10 dist 0.003604000201448798 idx 2437
dist 0.003603994846343994 idx 281
pyknn ib 0, in 3835, ip 7 dist 0.004132998175919056 idx 1093
dist 0.004132270812988281 idx 2320
pyknn ib 0, in 3835, ip 8 dist 0.004132998175919056 idx 2320
dist 0.004132270812988281 idx 1093
pyknn ib 0, in 3835, ip 18 dist 0.010659990832209587 idx 810
dist 0.010659217834472656 idx 3766
pyknn ib 0, in 3835, ip 19 dist 0.010659990832209587 idx 3766
dist 0.010659217834472656 idx 810
pyknn ib 0, in 3842, ip 8 dist 0.005413996987044811 idx 2767
dist 0.005414038896560669 idx 3503
pyknn ib 0, in 3842, ip 9 dist 0.005413996987044811 idx 3503
dist 0.005414038896560669 idx 2767
pyknn ib 0, in 3843, ip 12 dist 0.005192999728024006 idx 847
dist 0.005192995071411133 idx 2932
pyknn ib 0, in 3843, ip 13 dist 0.005192999728024006 idx 2932
dist 0.005192995071411133 idx 847
pyknn ib 0, in 3851, ip 7 dist 0.0037380007561296225 idx 1333
dist 0.003738000988960266 idx 1388
pyknn ib 0, in 3851, ip 8 dist 0.0037380007561296225 idx 1388
dist 0.003738000988960266 idx 1333
pyknn ib 0, in 3853, ip 2 dist 0.0003970006946474314 idx 818
dist 0.00039702653884887695 idx 3318
pyknn ib 0, in 3853, ip 3 dist 0.0003970006946474314 idx 3318
dist 0.00039702653884887695 idx 818
pyknn ib 0, in 3853, ip 18 dist 0.025717997923493385 idx 3462
dist 0.025718003511428833 idx 3465
pyknn ib 0, in 3853, ip 19 dist 0.025717997923493385 idx 3465
dist 0.025718003511428833 idx 3462
pyknn ib 0, in 3858, ip 3 dist 0.004686000291258097 idx 636
dist 0.004686005413532257 idx 3362
pyknn ib 0, in 3858, ip 4 dist 0.004686000291258097 idx 3362
dist 0.004686005413532257 idx 636
pyknn ib 0, in 3859, ip 8 dist 0.0045179990120232105 idx 2502
dist 0.004517912864685059 idx 3168
pyknn ib 0, in 3859, ip 9 dist 0.0045179990120232105 idx 3168
dist 0.004517912864685059 idx 2502
pyknn ib 0, in 3859, ip 17 dist 0.0062250057235360146 idx 2316
dist 0.006224989891052246 idx 2761
pyknn ib 0, in 3859, ip 18 dist 0.0062250057235360146 idx 2761
dist 0.006224989891052246 idx 2316
pyknn ib 0, in 3860, ip 1 dist 0.001565000507980585 idx 768
dist 0.00156499445438385 idx 2765
pyknn ib 0, in 3860, ip 2 dist 0.001565000507980585 idx 2765
dist 0.00156499445438385 idx 768
pyknn ib 0, in 3864, ip 8 dist 0.0025200005620718002 idx 1219
dist 0.0025200843811035156 idx 3352
pyknn ib 0, in 3864, ip 9 dist 0.0025200005620718002 idx 3352
dist 0.0025200843811035156 idx 1219
pyknn ib 0, in 3866, ip 9 dist 0.008149027824401855 idx 3519
dist 0.008148193359375 idx 4066
pyknn ib 0, in 3866, ip 10 dist 0.008149027824401855 idx 4066
dist 0.008148193359375 idx 3519
pyknn ib 0, in 3866, ip 18 dist 0.011526023969054222 idx 2377
dist 0.011525154113769531 idx 3132
pyknn ib 0, in 3866, ip 19 dist 0.011526023969054222 idx 3132
dist 0.011525154113769531 idx 2377
pyknn ib 0, in 3867, ip 9 dist 0.004133999813348055 idx 857
dist 0.004133939743041992 idx 2424
pyknn ib 0, in 3867, ip 10 dist 0.004133999813348055 idx 2424
dist 0.004133939743041992 idx 857
pyknn ib 0, in 3868, ip 18 dist 0.012170001864433289 idx 1333
dist 0.012169986963272095 idx 1388
pyknn ib 0, in 3868, ip 19 dist 0.012170001864433289 idx 1388
dist 0.012169986963272095 idx 1333
pyknn ib 0, in 3869, ip 3 dist 0.002033001510426402 idx 938
dist 0.0020329952239990234 idx 1350
pyknn ib 0, in 3869, ip 4 dist 0.002033001510426402 idx 1350
dist 0.0020329952239990234 idx 938
pyknn ib 0, in 3872, ip 4 dist 0.0024029994383454323 idx 683
dist 0.0024029985070228577 idx 2705
pyknn ib 0, in 3872, ip 5 dist 0.0024029994383454323 idx 2705
dist 0.0024029985070228577 idx 3377
pyknn ib 0, in 3872, ip 6 dist 0.0024029994383454323 idx 3377
dist 0.0024029985070228577 idx 683
pyknn ib 0, in 3873, ip 4 dist 0.0017179968999698758 idx 1304
dist 0.001717984676361084 idx 2654
pyknn ib 0, in 3873, ip 5 dist 0.0017179968999698758 idx 2654
dist 0.001717984676361084 idx 1304
pyknn ib 0, in 3874, ip 10 dist 0.007155999541282654 idx 366
dist 0.0071561336517333984 idx 3555
pyknn ib 0, in 3874, ip 11 dist 0.007155999541282654 idx 3555
dist 0.0071561336517333984 idx 366
pyknn ib 0, in 3883, ip 2 dist 0.0005449995514936745 idx 158
dist 0.0005464553833007812 idx 1404
pyknn ib 0, in 3883, ip 3 dist 0.0005449995514936745 idx 1404
dist 0.0005464553833007812 idx 158
pyknn ib 0, in 3884, ip 7 dist 0.0038480001967400312 idx 1018
dist 0.003847837448120117 idx 3982
pyknn ib 0, in 3884, ip 8 dist 0.0038480001967400312 idx 3982
dist 0.003847837448120117 idx 1018
pyknn ib 0, in 3887, ip 10 dist 0.006790000945329666 idx 3107
dist 0.006789207458496094 idx 1966
pyknn ib 0, in 3887, ip 11 dist 0.006790002807974815 idx 1966
dist 0.006789207458496094 idx 3107
pyknn ib 0, in 3890, ip 0 dist 0.0 idx 1426
dist 0.0 idx 3890
pyknn ib 0, in 3890, ip 1 dist 0.0 idx 3890
dist 0.0 idx 1426
pyknn ib 0, in 3890, ip 6 dist 0.0032750004902482033 idx 2328
dist 0.0032750368118286133 idx 3774
pyknn ib 0, in 3890, ip 7 dist 0.0032750004902482033 idx 3774
dist 0.0032750368118286133 idx 2328
pyknn ib 0, in 3894, ip 4 dist 0.002228998579084873 idx 1254
dist 0.0022287368774414062 idx 2552
pyknn ib 0, in 3894, ip 5 dist 0.002228998579084873 idx 2552
dist 0.0022287368774414062 idx 1254
pyknn ib 0, in 3899, ip 11 dist 0.006374003365635872 idx 497
dist 0.006373763084411621 idx 2785
pyknn ib 0, in 3899, ip 12 dist 0.006374003365635872 idx 2785
dist 0.006373763084411621 idx 497
pyknn ib 0, in 3902, ip 2 dist 0.000996999442577362 idx 1333
dist 0.0009969770908355713 idx 1388
pyknn ib 0, in 3902, ip 3 dist 0.000996999442577362 idx 1388
dist 0.0009969770908355713 idx 1333
pyknn ib 0, in 3906, ip 11 dist 0.008240998722612858 idx 768
dist 0.00824098289012909 idx 2765
pyknn ib 0, in 3906, ip 12 dist 0.008240998722612858 idx 2765
dist 0.00824098289012909 idx 768
pyknn ib 0, in 3909, ip 0 dist 0.0 idx 744
dist 0.0 idx 3909
pyknn ib 0, in 3909, ip 1 dist 0.0 idx 3909
dist 0.0 idx 744
pyknn ib 0, in 3909, ip 3 dist 0.0003130019176751375 idx 1031
dist 0.00031256675720214844 idx 2711
pyknn ib 0, in 3909, ip 4 dist 0.0003130019176751375 idx 1100
dist 0.00031256675720214844 idx 1031
pyknn ib 0, in 3909, ip 5 dist 0.0003130019176751375 idx 2711
dist 0.00031256675720214844 idx 1100
pyknn ib 0, in 3911, ip 3 dist 0.0003949997771997005 idx 2143
dist 0.00039499253034591675 idx 4072
pyknn ib 0, in 3911, ip 4 dist 0.0003949997771997005 idx 4072
dist 0.00039499253034591675 idx 2143
pyknn ib 0, in 3912, ip 18 dist 0.007466008421033621 idx 476
dist 0.007465362548828125 idx 784
pyknn ib 0, in 3912, ip 19 dist 0.007466008421033621 idx 784
dist 0.007465362548828125 idx 476
pyknn ib 0, in 3916, ip 12 dist 0.00708600040525198 idx 488
dist 0.007086008787155151 idx 2434
pyknn ib 0, in 3916, ip 13 dist 0.00708600040525198 idx 2434
dist 0.007086008787155151 idx 488
pyknn ib 0, in 3918, ip 13 dist 0.009893002919852734 idx 3325
dist 0.009893059730529785 idx 3729
pyknn ib 0, in 3918, ip 14 dist 0.009893002919852734 idx 3729
dist 0.009893059730529785 idx 3325
pyknn ib 0, in 3918, ip 18 dist 0.012113000266253948 idx 1426
dist 0.012112975120544434 idx 3890
pyknn ib 0, in 3918, ip 19 dist 0.012113000266253948 idx 3890
dist 0.012112975120544434 idx 1426
pyknn ib 0, in 3921, ip 3 dist 0.003403998911380768 idx 281
dist 0.003403991460800171 idx 2437
pyknn ib 0, in 3921, ip 4 dist 0.003403998911380768 idx 2437
dist 0.003403991460800171 idx 281
pyknn ib 0, in 3931, ip 5 dist 0.0017810005228966475 idx 2701
dist 0.001781463623046875 idx 3754
pyknn ib 0, in 3931, ip 6 dist 0.0017810005228966475 idx 3754
dist 0.001781463623046875 idx 2701
pyknn ib 0, in 3933, ip 0 dist 0.0 idx 2745
dist -4.76837158203125e-07 idx 3933
pyknn ib 0, in 3933, ip 1 dist 0.0 idx 3933
dist -4.76837158203125e-07 idx 2745
pyknn ib 0, in 3936, ip 13 dist 0.013471986167132854 idx 1031
dist 0.013471603393554688 idx 1100
pyknn ib 0, in 3936, ip 14 dist 0.013471986167132854 idx 1100
dist 0.013471603393554688 idx 2711
pyknn ib 0, in 3936, ip 15 dist 0.013471986167132854 idx 2711
dist 0.013471603393554688 idx 1031
pyknn ib 0, in 3936, ip 16 dist 0.013521000742912292 idx 744
dist 0.013520956039428711 idx 3909
pyknn ib 0, in 3936, ip 17 dist 0.013521000742912292 idx 3909
dist 0.013520956039428711 idx 744
pyknn ib 0, in 3938, ip 4 dist 0.004649000242352486 idx 1555
dist 0.004649162292480469 idx 2866
pyknn ib 0, in 3938, ip 5 dist 0.004649000242352486 idx 2866
dist 0.004649162292480469 idx 1555
pyknn ib 0, in 3939, ip 0 dist 0.0 idx 1248
dist 0.0 idx 3939
pyknn ib 0, in 3939, ip 1 dist 0.0 idx 3939
dist 0.0 idx 1248
pyknn ib 0, in 3940, ip 2 dist 0.002899995306506753 idx 1231
dist 0.002899169921875 idx 533
pyknn ib 0, in 3940, ip 3 dist 0.002900000661611557 idx 533
dist 0.002899646759033203 idx 1231
pyknn ib 0, in 3940, ip 14 dist 0.00899400096386671 idx 1021
dist 0.008993148803710938 idx 1857
pyknn ib 0, in 3940, ip 15 dist 0.00899400096386671 idx 1857
dist 0.008993148803710938 idx 1021
pyknn ib 0, in 3942, ip 1 dist 0.0005389998550526798 idx 2767
dist 0.0005390048027038574 idx 3503
pyknn ib 0, in 3942, ip 2 dist 0.0005389998550526798 idx 3503
dist 0.0005390048027038574 idx 2767
pyknn ib 0, in 3943, ip 5 dist 0.002406000392511487 idx 1426
dist 0.002406001091003418 idx 3890
pyknn ib 0, in 3943, ip 6 dist 0.002406000392511487 idx 3890
dist 0.002406001091003418 idx 1426
pyknn ib 0, in 3943, ip 9 dist 0.004201000090688467 idx 2328
dist 0.004200935363769531 idx 3774
pyknn ib 0, in 3943, ip 10 dist 0.004201000090688467 idx 3774
dist 0.004200935363769531 idx 2328
pyknn ib 0, in 3950, ip 8 dist 0.003989000804722309 idx 1718
dist 0.003989040851593018 idx 2775
pyknn ib 0, in 3950, ip 9 dist 0.003989000804722309 idx 2775
dist 0.003989040851593018 idx 1718
pyknn ib 0, in 3951, ip 8 dist 0.004125999752432108 idx 2266
dist 0.004126548767089844 idx 3388
pyknn ib 0, in 3951, ip 9 dist 0.004125999752432108 idx 3388
dist 0.004126548767089844 idx 2266
pyknn ib 0, in 3952, ip 5 dist 0.003297999268397689 idx 744
dist 0.0032978057861328125 idx 3909
pyknn ib 0, in 3952, ip 6 dist 0.003297999268397689 idx 3909
dist 0.0032978057861328125 idx 744
pyknn ib 0, in 3952, ip 9 dist 0.005625006277114153 idx 1031
dist 0.005624532699584961 idx 2711
pyknn ib 0, in 3952, ip 11 dist 0.005625006277114153 idx 2711
dist 0.005624532699584961 idx 1031
pyknn ib 0, in 3953, ip 9 dist 0.009367999620735645 idx 542
dist 0.009368062019348145 idx 1590
pyknn ib 0, in 3953, ip 10 dist 0.009367999620735645 idx 1590
dist 0.009368062019348145 idx 542
pyknn ib 0, in 3953, ip 16 dist 0.014188993722200394 idx 798
dist 0.014188885688781738 idx 3397
pyknn ib 0, in 3953, ip 17 dist 0.014188996516168118 idx 3397
dist 0.014189004898071289 idx 798
pyknn ib 0, in 3955, ip 6 dist 0.0023769985418766737 idx 3325
dist 0.002377033233642578 idx 3729
pyknn ib 0, in 3955, ip 7 dist 0.0023769985418766737 idx 3729
dist 0.002377033233642578 idx 3325
pyknn ib 0, in 3959, ip 6 dist 0.0041410005651414394 idx 2780
dist 0.004140615463256836 idx 3638
pyknn ib 0, in 3959, ip 7 dist 0.0041410005651414394 idx 3638
dist 0.004140615463256836 idx 2780
pyknn ib 0, in 3962, ip 4 dist 0.001824999344535172 idx 768
dist 0.0018250048160552979 idx 2765
pyknn ib 0, in 3962, ip 5 dist 0.001824999344535172 idx 2765
dist 0.0018250048160552979 idx 768
pyknn ib 0, in 3962, ip 11 dist 0.0032780019100755453 idx 281
dist 0.003278002142906189 idx 2437
pyknn ib 0, in 3962, ip 12 dist 0.0032780019100755453 idx 2437
dist 0.003278002142906189 idx 281
pyknn ib 0, in 3971, ip 12 dist 0.007450995501130819 idx 1157
dist 0.007451057434082031 idx 2023
pyknn ib 0, in 3971, ip 13 dist 0.007450995501130819 idx 2023
dist 0.007451057434082031 idx 1157
pyknn ib 0, in 3976, ip 1 dist 0.0003900023002643138 idx 963
dist 0.00039005279541015625 idx 3703
pyknn ib 0, in 3976, ip 2 dist 0.0003900023002643138 idx 3703
dist 0.00039005279541015625 idx 963
pyknn ib 0, in 3977, ip 5 dist 0.003753000171855092 idx 767
dist 0.0037530213594436646 idx 1375
pyknn ib 0, in 3977, ip 6 dist 0.003753000171855092 idx 954
dist 0.0037530213594436646 idx 767
pyknn ib 0, in 3977, ip 7 dist 0.003753000171855092 idx 1375
dist 0.0037530213594436646 idx 954
pyknn ib 0, in 3982, ip 0 dist 0.0 idx 1018
dist 0.0 idx 3982
pyknn ib 0, in 3982, ip 1 dist 0.0 idx 3982
dist 0.0 idx 1018
pyknn ib 0, in 3987, ip 3 dist 0.0009689986472949386 idx 282
dist 0.0009691715240478516 idx 2323
pyknn ib 0, in 3987, ip 4 dist 0.0009689986472949386 idx 2323
dist 0.0009691715240478516 idx 282
pyknn ib 0, in 3988, ip 8 dist 0.004057002253830433 idx 2745
dist 0.004056692123413086 idx 3933
pyknn ib 0, in 3988, ip 9 dist 0.004057002253830433 idx 3933
dist 0.004056692123413086 idx 2745
pyknn ib 0, in 3989, ip 7 dist 0.007250993978232145 idx 1031
dist 0.007250308990478516 idx 1100
pyknn ib 0, in 3989, ip 8 dist 0.007250993978232145 idx 1100
dist 0.007250308990478516 idx 1031
pyknn ib 0, in 3989, ip 14 dist 0.010538001544773579 idx 744
dist 0.010537862777709961 idx 3909
pyknn ib 0, in 3989, ip 15 dist 0.010538001544773579 idx 3909
dist 0.010537862777709961 idx 744
pyknn ib 0, in 3996, ip 0 dist 0.0 idx 2854
dist 0.0 idx 3996
pyknn ib 0, in 3996, ip 1 dist 0.0 idx 3996
dist 0.0 idx 2854
pyknn ib 0, in 3999, ip 12 dist 0.010126007720828056 idx 1018
dist 0.010125875473022461 idx 3982
pyknn ib 0, in 3999, ip 13 dist 0.010126007720828056 idx 3982
dist 0.010125875473022461 idx 1018
pyknn ib 0, in 4005, ip 11 dist 0.004081999883055687 idx 193
dist 0.004082083702087402 idx 231
pyknn ib 0, in 4005, ip 12 dist 0.004081999883055687 idx 231
dist 0.004082083702087402 idx 193
pyknn ib 0, in 4007, ip 7 dist 0.0034770015627145767 idx 1800
dist 0.003475189208984375 idx 2901
pyknn ib 0, in 4007, ip 8 dist 0.0034770015627145767 idx 2901
dist 0.003475189208984375 idx 1800
pyknn ib 0, in 4011, ip 4 dist 0.0019210001919418573 idx 281
dist 0.0019209980964660645 idx 2437
pyknn ib 0, in 4011, ip 5 dist 0.0019210001919418573 idx 2437
dist 0.0019209980964660645 idx 281
pyknn ib 0, in 4011, ip 8 dist 0.0032220007851719856 idx 768
dist 0.0032220035791397095 idx 2765
pyknn ib 0, in 4011, ip 9 dist 0.0032220007851719856 idx 2765
dist 0.0032220035791397095 idx 768
pyknn ib 0, in 4015, ip 6 dist 0.0012199964839965105 idx 1925
dist 0.0012197494506835938 idx 2416
pyknn ib 0, in 4015, ip 7 dist 0.0012199964839965105 idx 2416
dist 0.0012197494506835938 idx 1925
pyknn ib 0, in 4017, ip 9 dist 0.0036890103947371244 idx 366
dist 0.003688812255859375 idx 3555
pyknn ib 0, in 4017, ip 10 dist 0.0036890103947371244 idx 3555
dist 0.003688812255859375 idx 366
pyknn ib 0, in 4019, ip 8 dist 0.003205000888556242 idx 1225
dist 0.0032033920288085938 idx 1637
pyknn ib 0, in 4019, ip 9 dist 0.003205000888556242 idx 1637
dist 0.0032033920288085938 idx 1225
pyknn ib 0, in 4026, ip 7 dist 0.002222006907686591 idx 595
dist 0.0022215843200683594 idx 2077
pyknn ib 0, in 4026, ip 8 dist 0.002222006907686591 idx 2077
dist 0.0022215843200683594 idx 595
pyknn ib 0, in 4032, ip 12 dist 0.007041999604552984 idx 792
dist 0.0070416927337646484 idx 974
pyknn ib 0, in 4032, ip 13 dist 0.007041999604552984 idx 974
dist 0.0070416927337646484 idx 792
pyknn ib 0, in 4038, ip 2 dist 0.0010400002356618643 idx 636
dist 0.0010400041937828064 idx 3362
pyknn ib 0, in 4038, ip 3 dist 0.0010400002356618643 idx 3362
dist 0.0010400041937828064 idx 636
pyknn ib 0, in 4047, ip 5 dist 0.0014030011370778084 idx 719
dist 0.0014026165008544922 idx 3707
pyknn ib 0, in 4047, ip 6 dist 0.0014030011370778084 idx 3707
dist 0.0014026165008544922 idx 719
pyknn ib 0, in 4050, ip 0 dist 0.0 idx 2397
dist 0.0 idx 4050
pyknn ib 0, in 4050, ip 1 dist 0.0 idx 4050
dist 0.0 idx 2397
pyknn ib 0, in 4058, ip 6 dist 0.0026439952198415995 idx 1225
dist 0.0026445388793945312 idx 1637
pyknn ib 0, in 4058, ip 7 dist 0.0026439952198415995 idx 1637
dist 0.0026445388793945312 idx 1225
pyknn ib 0, in 4058, ip 8 dist 0.0026499878149479628 idx 29
dist 0.0026502609252929688 idx 1466
pyknn ib 0, in 4058, ip 9 dist 0.0026499878149479628 idx 1466
dist 0.0026502609252929688 idx 29
pyknn ib 0, in 4058, ip 19 dist 0.009620998986065388 idx 1176
dist 0.00962066650390625 idx 2555
pyknn ib 0, in 4061, ip 10 dist 0.006673999130725861 idx 3462
dist 0.006673991680145264 idx 3465
pyknn ib 0, in 4061, ip 11 dist 0.006673999130725861 idx 3465
dist 0.006673991680145264 idx 3462
pyknn ib 0, in 4062, ip 3 dist 0.001948998891748488 idx 315
dist 0.0019488334655761719 idx 3219
pyknn ib 0, in 4062, ip 4 dist 0.001948998891748488 idx 3219
dist 0.0019488334655761719 idx 315
pyknn ib 0, in 4063, ip 1 dist 6.1000100686214864e-05 idx 1951
dist 6.097555160522461e-05 idx 2710
pyknn ib 0, in 4063, ip 2 dist 6.1000100686214864e-05 idx 2710
dist 6.097555160522461e-05 idx 1951
pyknn ib 0, in 4063, ip 9 dist 0.006617994979023933 idx 1161
dist 0.006617993116378784 idx 2641
pyknn ib 0, in 4063, ip 10 dist 0.006617994979023933 idx 2641
dist 0.006617993116378784 idx 1161
pyknn ib 0, in 4065, ip 5 dist 0.0018000002019107342 idx 2790
dist 0.001800537109375 idx 3722
pyknn ib 0, in 4065, ip 6 dist 0.0018000002019107342 idx 3722
dist 0.001800537109375 idx 2790
pyknn ib 0, in 4065, ip 8 dist 0.0027250039856880903 idx 1906
dist 0.0027251243591308594 idx 3635
pyknn ib 0, in 4065, ip 9 dist 0.0027250039856880903 idx 3635
dist 0.0027251243591308594 idx 1906
pyknn ib 0, in 4066, ip 0 dist 0.0 idx 3519
dist 0.0 idx 4066
pyknn ib 0, in 4066, ip 1 dist 0.0 idx 4066
dist 0.0 idx 3519
pyknn ib 0, in 4066, ip 2 dist 0.0004419961478561163 idx 829
dist 0.00044155120849609375 idx 3173
pyknn ib 0, in 4066, ip 3 dist 0.0004419961478561163 idx 3173
dist 0.00044155120849609375 idx 829
pyknn ib 0, in 4070, ip 9 dist 0.004648996517062187 idx 1248
dist 0.004649162292480469 idx 3939
pyknn ib 0, in 4070, ip 10 dist 0.004648996517062187 idx 3939
dist 0.004649162292480469 idx 1248
pyknn ib 0, in 4072, ip 0 dist 0.0 idx 2143
dist 0.0 idx 4072
pyknn ib 0, in 4072, ip 1 dist 0.0 idx 4072
dist 0.0 idx 2143
pyknn ib 0, in 4074, ip 1 dist 0.0005799981881864369 idx 1259
dist 0.0005799531936645508 idx 310
pyknn ib 0, in 4074, ip 2 dist 0.0005799999344162643 idx 310
dist 0.0005799531936645508 idx 1259
pyknn ib 0, in 4083, ip 3 dist 0.0021730000153183937 idx 965
dist 0.0021734237670898438 idx 1552
pyknn ib 0, in 4083, ip 4 dist 0.0021730000153183937 idx 1552
dist 0.0021734237670898438 idx 965
pyknn ib 0, in 4087, ip 2 dist 0.00047799956519156694 idx 991
dist 0.000476837158203125 idx 2895
pyknn ib 0, in 4087, ip 3 dist 0.00047799956519156694 idx 2895
dist 0.000476837158203125 idx 991
pyknn ib 0, in 4088, ip 15 dist 0.012462000362575054 idx 965
dist 0.012462615966796875 idx 1552
pyknn ib 0, in 4088, ip 16 dist 0.012462000362575054 idx 1552
dist 0.012462615966796875 idx 965
pyknn ib 0, in 4089, ip 0 dist 0.0 idx 3631
dist 0.0 idx 4089
pyknn ib 0, in 4089, ip 1 dist 0.0 idx 4089
dist 0.0 idx 3631
CHECK1: True
"""

# print(idx)

# speed test
# loader = DataLoader(
#     dataset,
#     batch_size=2,
#     num_workers=8,
#     pin_memory=True,
#     shuffle=False
# )
# speed_test(0, loader)
# speed_test(1, loader)
# speed_test(2, loader)
# speed_test(3, loader)
